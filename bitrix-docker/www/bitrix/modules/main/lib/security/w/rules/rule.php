<? namespace Bitrix\Main\Security\W\Rules;$GLOBALS['____1707179346']= array(base64_decode('aXN'.'fc3R'.'yaW5n'),base64_decode('c3RydG9sb3'.'dlcg=='),base64_decode('a'.'X'.'N'.'fYXJyYXk='),base64_decode('aXNfc'.'3RyaW5n'),base64_decode('Z3'.'pk'.'ZWNv'.'Z'.'G'.'U='),base64_decode('Y'.'mFzZTY0'.'X2Rl'.'Y2'.'9kZQ=='),base64_decode(''.'dXJ'.'sZ'.'GV'.'jb2Rl'),base64_decode('YXJ'.'yY'.'Xl'.'fcmV2ZX'.'Jz'.'ZQ=='),base64_decode('Z3plbm'.'N'.'vZGU'.'='),base64_decode(''.'Y'.'mFzZ'.'TY0X'.'2V'.'uY29kZQ=='),base64_decode('dXJs'.'ZW5jb2Rl'),base64_decode('YmluMmh'.'l'.'eA='.'='),base64_decode('aXNfYXJyYXk='),base64_decode('c3RydG9'.'sb3dlcg=='),base64_decode(''.'aXNfYXJyYXk='),base64_decode(''.'am9p'.'bg'.'=='),base64_decode('Z'.'m5tYXRjaA=='),base64_decode('cm'.'F3d'.'XJsZGVjb2R'.'l'),base64_decode('c3Vic3Ry'),base64_decode('c3Vic3Ry'),base64_decode('c3RyX3'.'J'.'lcGxh'.'Y'.'2U='),base64_decode(''.'cHJl'.'Z'.'19xd'.'W90Z'.'Q'.'=='),base64_decode('cH'.'JlZ19tYXR'.'jaA'.'=='));if(!function_exists(__NAMESPACE__.'\\___163438698')){function ___163438698($_1652505026){static $_1805349437= false; if($_1805349437 == false) $_1805349437=array('Y'.'WN0'.'aW'.'9u','a'.'W5'.'0'.'d'.'mFs',''.'c'.'GF'.'0aA==','Y29'.'udGV4d'.'A='.'=','a'.'2V'.'5cw==','cHJvY2Vzcw'.'==','ZW5'.'jb2R'.'p'.'bmc=',''.'cHJlZ19yZ'.'X'.'B'.'sY'.'W'.'N'.'l','cGF0aA==','Y29udG'.'V4dA==','a'.'2V5cw==','cHJv'.'Y2'.'Vz'.'cw==','ZW'.'5jb2Rp'.'bmc=','cGF'.'0d'.'GVy'.'bg==','cHJlZ19'.'t'.'YXRj'.'aA'.'==',''.'cGF0aA='.'=','Y29udGV'.'4dA==',''.'a2'.'V5cw==',''.'cHJ'.'v'.'Y2Vzcw='.'=','ZW5jb'.'2Rp'.'bmc=','cGF0d'.'GVybg==','cG9z'.'dF9hY3Rpb'.'2'.'4=','Y2h'.'lY2tfY3Ny'.'Zg='.'=',''.'c'.'GF0aA==','Y'.'29u'.'dGV4d'.'A==','a2V5cw==','cHJv'.'Y'.'2Vzcw'.'==','ZW5'.'jb2R'.'pbmc'.'=',''.'c'.'GF0dGV'.'yb'.'g='.'=','YWN0aW9u',''.'Y'.'WN0a'.'W9u','Y'.'W'.'N'.'0aW9'.'u','YWN0aW'.'9u','YWN0aW'.'9'.'u','YWN0a'.'W9u',''.'cG9zdF9hY3R'.'pb24=','Z'.'W'.'5jb2Rpbmc=','ZW5'.'jb2Rpbmc'.'=',''.'ZW'.'5j'.'b2Rpbmc=','ZW5jb2Rp'.'bm'.'c=','ZW5jb'.'2Rpbmc=','ZW'.'5'.'jb2R'.'pbm'.'c'.'=','Z3o=','YmF'.'zZTY0','dXJs','aGV4','Lg'.'==','L'.'w'.'==','aW5kZXgu'.'c'.'G'.'hw','L2luZGV4'.'Ln'.'BocA'.'==','U'.'0NS'.'SVBUX'.'05'.'B'.'TUU=',''.'L2lu'.'ZGV'.'4'.'LnB'.'ocA==','U0'.'N'.'SSVBUX'.'05BTU'.'U'.'=','U0N'.'SSVBUX05'.'BTU'.'U=','U0NSSVBUX05BTUU'.'=','f'.'g==','fl4=','fg==','X'.'H4=','JH4'.'=');return base64_decode($_1805349437[$_1652505026]);}}; use Bitrix\Main\IO\Path; use Bitrix\Main\Web\Uri; use Bitrix\Main\Security\W\Rules\Results\ModifyResult; abstract class Rule{ protected $_280045476; protected $_247377770; protected $_1182641260; protected $_1559254185; protected $_880297582; public static function make(array $_1700145603):?static{ $_1700145603= static::prepareRuleParameters($_1700145603); return match($_1700145603[___163438698(0)]){ ___163438698(1) => new IntvalRule( $_1700145603[___163438698(2)], $_1700145603[___163438698(3)], $_1700145603[___163438698(4)], $_1700145603[___163438698(5)], $_1700145603[___163438698(6)]), ___163438698(7) => new PregReplaceRule( $_1700145603[___163438698(8)], $_1700145603[___163438698(9)], $_1700145603[___163438698(10)], $_1700145603[___163438698(11)], $_1700145603[___163438698(12)], $_1700145603[___163438698(13)]), ___163438698(14) => new PregMatchRule( $_1700145603[___163438698(15)], $_1700145603[___163438698(16)], $_1700145603[___163438698(17)], $_1700145603[___163438698(18)], $_1700145603[___163438698(19)], $_1700145603[___163438698(20)], $_1700145603[___163438698(21)]), ___163438698(22) => new CsrfRule( $_1700145603[___163438698(23)], $_1700145603[___163438698(24)], $_1700145603[___163438698(25)], $_1700145603[___163438698(26)], $_1700145603[___163438698(27)], $_1700145603[___163438698(28)],), default => null,};} protected static function prepareRuleParameters(array $_1771443658): array{ if($GLOBALS['____1707179346'][0]($_1771443658[___163438698(29)])){ $_1771443658[___163438698(30)]= $GLOBALS['____1707179346'][1]($_1771443658[___163438698(31)]);} elseif($GLOBALS['____1707179346'][2]($_1771443658[___163438698(32)])){ $_563677621= $_1771443658[___163438698(33)]; $_1771443658[___163438698(34)]= $_563677621[(198*2-396)]; $_1771443658[___163438698(35)]= $_563677621[round(0+0.25+0.25+0.25+0.25)];} $_1771443658[___163438698(36)]=!empty($_1771443658[___163438698(37)])? $_1771443658[___163438698(38)]:[]; if($GLOBALS['____1707179346'][3]($_1771443658[___163438698(39)])){ $_1771443658[___163438698(40)]=[$_1771443658[___163438698(41)]];} return $_1771443658;}  public function __construct($_280045476, $_247377770, $_1182641260, $_1559254185, $_880297582){ $this->_280045476= $_280045476; $this->_247377770= $this->castContext($_247377770); $this->_1182641260= $this->castKeys($_1182641260); $this->_1559254185= $_1559254185; $this->_880297582= $_880297582;} public function evaluateValue($_622363904){ if(!empty($this->_880297582)){ foreach($this->_880297582 as $_533939624){ $_622363904= match($_533939624){ 'gz' => $GLOBALS['____1707179346'][4]($_622363904), 'base64' => $GLOBALS['____1707179346'][5]($_622363904), 'url' => $GLOBALS['____1707179346'][6]($_622363904), 'hex' => hex2bin($_622363904)};}} $_2134369176= $this->evaluate($_622363904); if(!empty($this->_880297582) && $_2134369176 instanceof ModifyResult){ $_1951462704= $_2134369176->getCleanValue(); foreach($GLOBALS['____1707179346'][7]($this->_880297582) as $_533939624){ $_1951462704= match($_533939624){ ___163438698(42) => $GLOBALS['____1707179346'][8]($_1951462704), ___163438698(43) => $GLOBALS['____1707179346'][9]($_1951462704), ___163438698(44) => $GLOBALS['____1707179346'][10]($_1951462704), ___163438698(45) => $GLOBALS['____1707179346'][11]($_1951462704)};} $_2134369176= new ModifyResult($_1951462704);} return $_2134369176;} abstract public function evaluate($_622363904); protected function castContext($_247377770){ if(!$GLOBALS['____1707179346'][12]($_247377770)){ $_247377770=[$_247377770];} foreach($_247377770 as $_1758602238 => $_1119925907){ $_247377770[$_1758602238]= $GLOBALS['____1707179346'][13]($_1119925907);} return $_247377770;} protected function castKeys($_1182641260){ if(!$GLOBALS['____1707179346'][14]($_1182641260)){ $_1182641260=[$_1182641260];} return $_1182641260;} public function matchKey(array $_1161708798): bool{ $_1161708798= $GLOBALS['____1707179346'][15](___163438698(46), $_1161708798); foreach($this->_1182641260 as $_687617090){   if($GLOBALS['____1707179346'][16]($_687617090, $_1161708798)){ return true;}} return false;}  public function matchPath($_1821459622){ if($this->_280045476 === '*'){ return true;}  $_1800914388= new Uri($_1821459622); $_414703232= $_1800914388->getPath(); $_414703232= $GLOBALS['____1707179346'][17]($_414703232);      if(str_ends_with($_414703232, ___163438698(47))){ $_414703232 .= ___163438698(48);} $_414703232= Path::normalize($_414703232);  $_950749874[]= $_414703232; if(str_ends_with($_414703232, ___163438698(49))){ $_950749874[]= $GLOBALS['____1707179346'][18]($_414703232,(167*2-334),-round(0+1.8+1.8+1.8+1.8+1.8));} elseif(str_ends_with($_SERVER[___163438698(50)], ___163438698(51))){ $_950749874[]= $GLOBALS['____1707179346'][19]($_SERVER[___163438698(52)], min(56,0,18.666666666667),-round(0+2.25+2.25+2.25+2.25));} if($_414703232 !== $_SERVER[___163438698(53)]){ $_950749874[]= $_SERVER[___163438698(54)];}  if(str_starts_with($this->_280045476, ___163438698(55))){ $_99001828= $this->_280045476;} else{ $_99001828= ___163438698(56). $GLOBALS['____1707179346'][20](___163438698(57), ___163438698(58), $GLOBALS['____1707179346'][21]($this->_280045476)). ___163438698(59);} foreach($_950749874 as $_1401204085){ if($this->_280045476 === $_1401204085 || $GLOBALS['____1707179346'][22]($_99001828, $_1401204085)){ return true;}} return false;}  public function getPath(){ return $this->_280045476;}  public function getContext(){ return $this->_247377770;}  public function getKeys(){ return $this->_1182641260;}  public function getProcess(){ return $this->_1559254185;}}?>